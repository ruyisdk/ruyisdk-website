"use strict";(globalThis.webpackChunkruyisdk=globalThis.webpackChunkruyisdk||[]).push([[8892],{39229(n,t,e){e.d(t,{R:()=>o,x:()=>a});var i=e(30758);const s={},r=i.createContext(s);function o(n){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof n?n(t):{...t,...n}},[t,n])}function a(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:o(n.components),i.createElement(r.Provider,{value:t},n.children)}},88461(n,t,e){e.r(t),e.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var i=e(86070),s=e(39229);const r={sidebar_position:7},o="\u6784\u5efa milkv-duo-examples \u793a\u4f8b\u7a0b\u5e8f",a={id:"Package-Manager/cases/case7",title:"\u6784\u5efa milkv-duo-examples \u793a\u4f8b\u7a0b\u5e8f",description:"\u9996\u5148\u5b89\u88c5\u5fc5\u8981\u7684\u4f9d\u8d56\uff1a",source:"@site/docs/Package-Manager/cases/case7.md",sourceDirName:"Package-Manager/cases",slug:"/Package-Manager/cases/case7",permalink:"/docs/Package-Manager/cases/case7",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528 QEMU \u548c LLVM",permalink:"/docs/Package-Manager/cases/case6"},next:{title:"\u66f4\u591a\u4fe1\u606f",permalink:"/docs/Package-Manager/misc"}},c={},l=[];function d(n){const t={code:"code",h1:"h1",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"\u6784\u5efa-milkv-duo-examples-\u793a\u4f8b\u7a0b\u5e8f",children:"\u6784\u5efa milkv-duo-examples \u793a\u4f8b\u7a0b\u5e8f"}),"\n",(0,i.jsx)(t.p,{children:"\u9996\u5148\u5b89\u88c5\u5fc5\u8981\u7684\u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",metastring:'input="1"',children:"$ ruyi install gnu-milkv-milkv-duo-musl-bin\n"})}),"\n",(0,i.jsx)(t.p,{children:"\u89e3\u5305\u51fa milkv-duo-examples \u5e76\u7f16\u8bd1\uff1a"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",metastring:'input="1-3"',children:"$ mkdir test-duo-examples\n$ cd test-duo-examples\n$ ruyi extract milkv-duo-examples\n"})}),"\n",(0,i.jsx)(t.p,{children:"\u4fee\u6539 envsetup.sh \u7684\u5185\u5bb9\uff1a"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'#!/bin/bash\n\nscript_dir=$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" &> /dev/null && pwd)\necho "script_dir: ${script_dir}"\n\nmilkv_debug=0\n\nmilkv_chip=\nmilkv_arch=\n\nhost_tools_pkg="gnu-milkv-milkv-duo-musl-bin"\nhost_tools=${script_dir}/host-tools/ruyi-venv\n\nfunction print_info()    { printf "\\e[1;92m%s\\e[0m\\n" "$1"; }\nfunction print_warning() { printf "\\e[1;93m%s\\e[0m\\n" "$1"; }\nfunction print_note()    { printf "\\e[1;94m%s\\e[0m\\n" "$1"; }\nfunction print_err()     { printf "\\e[1;31mError: %s\\e[0m\\n" "$1"; }\n\nfunction choose_target() {\n\techo "Select Product:"\n\tprint_info "1. Duo (CV1800B)"\n\tprint_info "2. Duo256M (SG2002) or DuoS (SG2000)"\n\tread -p "Which would you like: " chip_index\n\n\tif [ "${chip_index}" -eq 1 ]; then\n\t\tmilkv_chip="CV180X"\n\t\tmilkv_arch="riscv64"\n\telif [ "${chip_index}" -eq 2 ]; then\n\t\tmilkv_chip="CV181X"\n\t\tmilkv_arch="riscv64"\n\telse\n\t\tprint_err "Nothing selected for Chip."\n\t\treturn 1\n\tfi\n\n\tprint_note "CHIP: ${milkv_chip}"\n\tprint_note "ARCH: ${milkv_arch}"\n}\n\nfunction check_host_tools() {\n\tif [ ! -d ${host_tools} ]; then\n\t\tprint_warning "host-tools does not exist, download it now..."\n\t\truyi install ${host_tools_pkg}\n\t\tmkdir -p $(dirname ${host_tools})\n\t\truyi venv -t ${host_tools_pkg} milkv-duo ${host_tools}\n\t\tif [ $? -ne 0 ]; then\n\t\t\tprint_err "Get the host-tools pkg failed!"\n\t\t\treturn 1\n\t\tfi\n\telse\n\t\tif [ ! -e ${host_tools}/bin/ruyi-activate ]; then\n\t\t\tprint_warning "Ruyi Virtual Environment broken!"\n\t\t\tprint_warning "Please manually delete it first. [ ${host_tools} ]"\n\t\t\tprint_warning "Then source the script again."\n\t\t\treturn 2\n\t\tfi\n\tfi\n}\n\nchoose_target\n[[ "${?}" -eq 0 ]] || return 1\n\npushd ${script_dir}\ncheck_host_tools\n[[ "${?}" -eq 0 ]] || {\n\tpopd\n\treturn 1\n}\npopd\n\nsys_inc="${script_dir}/include/system"\n\nif [[ "${milkv_arch}" == "riscv64" ]]; then\n\n\tarch_cflags="-mcpu=c906fdv -march=rv64imafdcv0p7xthead -mcmodel=medany -mabi=lp64d"\n\tarch_ldflags="-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64"\n\n\texport TOOLCHAIN_PREFIX=riscv64-unknown-linux-musl-\n\nelse\n\tprint_err "Invalid ARCH parameter!"\n\treturn 1\nfi\n\nif [[ "${milkv_chip}" == "CV180X" ]]; then\n\tsys_lib="${script_dir}/libs/system/musl_riscv64"\nelif [[ "${milkv_chip}" == "CV181X" ]]; then\n\tsys_lib="${script_dir}/libs/system/musl_riscv64"\nelse\n\tprint_err "Invalid CHIP parameter!"\n\treturn 1\nfi\n\nif [ "${milkv_debug}" -eq 1 ]; then\n\tdebug_cflags="-g -O0"\nelse\n\tdebug_cflags="-O3 -DNDEBUG"\nfi\n\nexport CC="${TOOLCHAIN_PREFIX}gcc"\nexport CFLAGS="${arch_cflags} ${debug_cflags} -I${sys_inc}"\nexport LDFLAGS="${arch_ldflags} -L${sys_lib}"\n\nexport CHIP="${milkv_chip}"\n\nsource ${host_tools}/bin/ruyi-activate\n\nprint_info "Environment is ready."\n'})}),"\n",(0,i.jsx)(t.p,{children:"\u542f\u52a8\u865a\u62df\u73af\u5883\uff1a"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",metastring:'input="1"',children:"$ source envsetup.sh\n"})}),"\n",(0,i.jsx)(t.p,{children:"\u5e94\u5f53\u53ef\u4ee5\u6b63\u5e38\u6784\u5efa\uff1a"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",metastring:'input="1-2"',children:"$ cd i2c/ssd1306_i2c\n$ make\n"})})]})}function p(n={}){const{wrapper:t}={...(0,s.R)(),...n.components};return t?(0,i.jsx)(t,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}}}]);